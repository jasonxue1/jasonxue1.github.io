<!DOCTYPE html>
<html>
<head>
    <title>AES 加密解密</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <h1>AES 加密解密</h1>
    <label for="userKey">请输入您的密钥：</label>
    <input type="text" id="userKey"><br><br>
    <label for="data">请输入要加密的数据：</label>
    <input type="text" id="data"><br><br>
    <button onclick="encryptData()">加密</button><br><br>
    <textarea id="output" rows="4" cols="50" readonly></textarea>

    <script>
        async function encryptData() {
            const userKey = document.getElementById('userKey').value;
            const data = document.getElementById('data').value;

            // 客户端第一层加密
            const encryptedData = aesEncrypt(userKey, data);

            // 将加密后的数据发送给服务器进行第二层加密
            const response = await fetch('https://safe-data-transfer.herokuapp.com/encrypt', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ encryptedData })
            });

            const result = await response.json();
            document.getElementById('output').value = result.doubleEncryptedData;
        }

        function aesEncrypt(key, data) {
            // 在客户端使用用户输入的密钥对数据进行 AES 加密
            // 返回加密后的数据
            const encryptedData = CryptoJS.AES.encrypt(data, key).toString();
            return encryptedData;
        }
    </script>
</body>
</html>
